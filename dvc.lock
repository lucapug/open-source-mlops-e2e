schema: '2.0'
stages:
  data_split:
    cmd: python src/stages/data_split.py --config=params.yaml
    deps:
    - path: data/raw
      md5: 6920135c1a76a56a030a224fb82afb28.dir
      size: 466888
      nfiles: 2
    - path: src/stages/data_split.py
      md5: 9fbed283d435189303ad63ed525ac366
      size: 1435
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          raw_data_dir: data/raw
          countries:
          - France
          - Spain
          feat_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
          processed_data_dir: data/processed
    outs:
    - path: data/processed
      md5: 9f384869826bdf146e6ff572c85d0d1e.dir
      size: 722258
      nfiles: 4
  train:
    cmd: python src/stages/train.py --config=params.yaml
    deps:
    - path: data/processed
      md5: 9f384869826bdf146e6ff572c85d0d1e.dir
      size: 722258
      nfiles: 4
    - path: src/stages/train.py
      md5: 2c9c73e54f3d0f11ad7a855e7089278c
      size: 2126
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          raw_data_dir: data/raw
          countries:
          - France
          - Spain
          feat_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        train:
          model_type: randomforest
          model_dir: models
          model_path: models/clf-model.joblib
          params:
            n_estimators: 50
            max_depth: 20
    outs:
    - path: models/clf-model.joblib
      md5: b2fb947795ffff9645b2cea63182d5c2
      size: 5193240
  eval:
    cmd: python src/stages/eval.py --config=params.yaml
    deps:
    - path: data/processed
      md5: 9f384869826bdf146e6ff572c85d0d1e.dir
      size: 722258
      nfiles: 4
    - path: models/clf-model.joblib
      md5: b2fb947795ffff9645b2cea63182d5c2
      size: 5193240
    - path: src/stages/eval.py
      md5: 5dc0b6e6bdf436234530ccb3657cb12a
      size: 2431
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          raw_data_dir: data/raw
          countries:
          - France
          - Spain
          feat_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
          processed_data_dir: data/processed
        train:
          model_type: randomforest
          model_dir: models
          model_path: models/clf-model.joblib
          params:
            n_estimators: 50
            max_depth: 20
    outs:
    - path: metrics.json
      md5: c38755343a377f2aba660e2d22fa989e
      size: 67
    - path: reports/feat_imp.csv
      md5: 611c02c480d60d1bb98214cca8e516a4
      size: 185
    - path: reports/figures/cm.png
      md5: f41b981fac5a77b285d4eab28e46f1f2
      size: 10280
  train_drift_detector:
    cmd: python src/stages/drift_detector.py --config=params.yaml
    deps:
    - path: data/processed
      md5: 9f384869826bdf146e6ff572c85d0d1e.dir
      size: 722258
      nfiles: 4
    - path: models/clf-model.joblib
      md5: b2fb947795ffff9645b2cea63182d5c2
      size: 5193240
    - path: src/stages/drift_detector.py
      md5: 046d9c962b279c852bac5fec0cbb3077
      size: 1388
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          raw_data_dir: data/raw
          countries:
          - France
          - Spain
          feat_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
          processed_data_dir: data/processed
        train:
          model_type: randomforest
          model_dir: models
          model_path: models/clf-model.joblib
          params:
            n_estimators: 50
            max_depth: 20
    outs:
    - path: models/drift_detector
      md5: 35424faa23c5908f3cb7f650a1d01cd7.dir
      size: 483667
      nfiles: 3
